<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumos Moda Fitness - Luz que inspira movimento</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    
    <!-- ‚úÖ FIREBASE SDK v9+ MODULAR -->
    <script type="module">
        // Firebase v9+ modular SDK
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getDatabase, ref, set, get, push, onValue, serverTimestamp, query, orderByChild } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js';

        // ‚úÖ Configura√ß√£o Firebase Lumos Fitness
        const firebaseConfig = {
            apiKey: "AIzaSyDJ9_XRz7kL8vN2QgF5MwP3Hx6KjY8ZrTc",
            authDomain: "lumos-fitness.firebaseapp.com",
            databaseURL: "https://lumos-fitness-default-rtdb.firebaseio.com/",
            projectId: "lumos-fitness",
            storageBucket: "lumos-fitness.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef123456789012345",
            measurementId: "G-ABC123DEF4"
        };

        // ‚úÖ Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const analytics = getAnalytics(app);

        console.log('‚úÖ Firebase Lumos inicializado com sucesso - SID');

        // ‚úÖ Tornar dispon√≠vel globalmente
        window.firebaseApp = app;
        window.firebaseDatabase = database;
        window.firebaseRef = ref;
        window.firebaseSet = set;
        window.firebaseGet = get;
        window.firebasePush = push;
        window.firebaseOnValue = onValue;
        window.firebaseServerTimestamp = serverTimestamp;
        window.firebaseQuery = query;
        window.firebaseOrderByChild = orderByChild;

        // ‚úÖ Migrar dados para Firebase ao carregar
        window.addEventListener('load', async () => {
            await migrarDadosLumosParaFirebase();
            configurarListenersProdutos();
            console.log('üöÄ Sistema Lumos Firebase ativo - SID');
        });

        // ‚úÖ Fun√ß√£o de migra√ß√£o completa
        async function migrarDadosLumosParaFirebase() {
            console.log('üîÑ SID: Iniciando migra√ß√£o Lumos para Firebase');
            
            try {
                // Verificar se j√° existem dados
                const produtosRef = ref(database, 'produtos');
                const snapshot = await get(produtosRef);
                
                if (!snapshot.exists()) {
                    console.log('üì¶ SID: Migrando produtos Lumos para Firebase...');
                    
                    // Dados dos produtos Lumos
                    const produtosLumos = [
                        {
                            id: 1,
                            nome: "Legging High Power Turquesa",
                            preco: 189.90,
                            precoOriginal: 239.90,
                            categoria: "Leggings",
                            descricao: "Legging de alta compress√£o com tecnologia dry-fit exclusiva",
                            tamanhos: ["PP", "P", "M", "G", "GG"],
                            cores: ["Turquesa", "Preto", "Rosa"],
                            estoque: 25,
                            destaque: true,
                            marca: 'Lumos Fitness',
                            ativo: true
                        },
                        {
                            id: 2,
                            nome: "Top Force Preto",
                            preco: 159.90,
                            categoria: "Tops",
                            descricao: "Top esportivo com suporte m√©dio e al√ßas ajust√°veis",
                            tamanhos: ["PP", "P", "M", "G", "GG"],
                            cores: ["Preto", "Branco", "Rosa"],
                            estoque: 18,
                            destaque: false,
                            marca: 'Lumos Fitness',
                            ativo: true
                        },
                        {
                            id: 3,
                            nome: "Conjunto Boss Completo",
                            preco: 349.90,
                            precoOriginal: 429.90,
                            categoria: "Conjuntos",
                            descricao: "Conjunto legging + top com modelagem exclusiva",
                            tamanhos: ["PP", "P", "M", "G", "GG"],
                            cores: ["Preto/Rosa", "Azul/Branco"],
                            estoque: 12,
                            destaque: true,
                            marca: 'Lumos Fitness',
                            ativo: true
                        },
                        {
                            id: 4,
                            nome: "Macaquinho Athleisure",
                            preco: 269.90,
                            categoria: "Macaquinhos",
                            descricao: "Pe√ßa vers√°til para treino e uso casual",
                            tamanhos: ["PP", "P", "M", "G", "GG"],
                            cores: ["Preto", "Nude", "Verde"],
                            estoque: 8,
                            destaque: false,
                            marca: 'Lumos Fitness',
                            ativo: true
                        },
                        {
                            id: 5,
                            nome: "Short Essence Alta Compress√£o",
                            preco: 189.90,
                            categoria: "Shorts",
                            descricao: "Short com compress√£o estrat√©gica e bolsos laterais",
                            tamanhos: ["PP", "P", "M", "G", "GG"],
                            cores: ["Preto", "Cinza", "Rosa"],
                            estoque: 20,
                            destaque: false,
                            marca: 'Lumos Fitness',
                            ativo: true
                        },
                        {
                            id: 6,
                            nome: "Cal√ßa Wide Leg Comfort",
                            preco: 249.90,
                            categoria: "Cal√ßas",
                            descricao: "Cal√ßa confort√°vel para o dia a dia e yoga",
                            tamanhos: ["PP", "P", "M", "G", "GG"],
                            cores: ["Preto", "Bege", "Marinho"],
                            estoque: 15,
                            destaque: false,
                            marca: 'Lumos Fitness',
                            ativo: true
                        }
                    ];

                    // Migrar cada produto
                    for (const produto of produtosLumos) {
                        const produtoRef = ref(database, `produtos/${produto.id}`);
                        await set(produtoRef, {
                            ...produto,
                            criadoEm: serverTimestamp(),
                            atualizadoEm: serverTimestamp()
                        });
                        console.log(`‚úÖ SID: Produto ${produto.nome} migrado`);
                    }

                    // Criar configura√ß√µes da empresa
                    const configRef = ref(database, 'configuracoes');
                    await set(configRef, {
                        empresa: {
                            nome: "Lumos Moda Fitness",
                            slogan: "Luz que inspira movimento",
                            email: "contato@lumosfitness.com",
                            whatsapp: "(11) 99999-9999",
                            instagram: "@lumosmodafitness"
                        },
                        versao: "1.0.0",
                        migradoEm: serverTimestamp(),
                        desenvolvido: "SID - NEW AGE"
                    });

                    console.log('üéâ SID: Migra√ß√£o Lumos completa - dados no Firebase!');
                } else {
                    console.log('‚úÖ SID: Dados j√° existem no Firebase');
                }
            } catch (error) {
                console.error('‚ùå SID: Erro na migra√ß√£o:', error);
            }
        }

        // ‚úÖ Configurar listeners em tempo real
        function configurarListenersProdutos() {
            console.log('üîÑ SID: Configurando listeners Firebase');
            
            const produtosRef = ref(database, 'produtos');
            onValue(produtosRef, (snapshot) => {
                if (snapshot.exists()) {
                    const produtosFirebase = snapshot.val();
                    console.log('üîî SID: Produtos atualizados do Firebase:', Object.keys(produtosFirebase).length);
                    
                    // Atualizar appData com dados do Firebase
                    if (window.appData) {
                        window.appData.produtos = Object.values(produtosFirebase);
                        
                        // Atualizar interface se estiver na p√°gina de produtos
                        if (window.appState && window.appState.currentPage === 'products') {
                            window.loadAllProducts && window.loadAllProducts();
                        }
                        
                        // Atualizar produtos em destaque na home
                        if (window.appState && window.appState.currentPage === 'home') {
                            window.loadFeaturedProducts && window.loadFeaturedProducts();
                        }
                    }
                } else {
                    console.log('‚ö†Ô∏è SID: Nenhum produto no Firebase');
                }
            }, (error) => {
                console.error('‚ùå SID: Erro no listener:', error);
            });
        }
    </script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header__content">
                <div class="header__logo">
                    <h1>Lumos</h1>
                    <span>Moda Fitness</span>
                </div>
                
                <nav class="header__nav">
                    <a href="#" data-page="home" class="nav-link active">In√≠cio</a>
                    <a href="#" data-page="products" class="nav-link">Produtos</a>
                    <a href="#" data-page="about" class="nav-link">Sobre</a>
                    <a href="#" data-page="admin" class="nav-link">Admin</a>
                </nav>
                
                <div class="header__actions">
                    <button class="btn-icon" data-action="search">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                    <button class="btn-icon" data-action="profile">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </button>
                    <button class="btn-icon cart-btn" data-action="cart">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="8" cy="21" r="1"></circle>
                            <circle cx="19" cy="21" r="1"></circle>
                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57L23 6H6"></path>
                        </svg>
                        <span class="cart-count">0</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Home Page -->
        <section id="page-home" class="page active">
            <!-- Hero -->
            <section class="hero">
                <div class="container">
                    <div class="hero__content">
                        <div class="hero__text">
                            <h2>Luz que inspira movimento</h2>
                            <p>Criamos pe√ßas que acompanham mulheres reais na rotina, no treino e na vida</p>
                            <button class="btn btn--primary btn--lg" data-action="shop-now">Comprar Agora</button>
                        </div>
                        <div class="hero__image">
                            <div class="hero__placeholder">
                                <svg width="200" height="200" viewBox="0 0 200 200" fill="currentColor">
                                    <rect width="200" height="200" rx="20" fill="var(--color-primary)" opacity="0.1"/>
                                    <circle cx="100" cy="80" r="30" fill="var(--color-primary)" opacity="0.3"/>
                                    <rect x="70" y="110" width="60" height="80" rx="5" fill="var(--color-primary)" opacity="0.3"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Featured Products -->
            <section class="featured-products">
                <div class="container">
                    <h3>Produtos em Destaque</h3>
                    <div class="products-grid" id="featured-products-grid">
                        <!-- Products will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Testimonials -->
            <section class="testimonials">
                <div class="container">
                    <h3>O que nossas clientes dizem</h3>
                    <div class="testimonials-grid" id="testimonials-grid">
                        <!-- Testimonials will be loaded here -->
                    </div>
                </div>
            </section>
        </section>

        <!-- Products Page -->
        <section id="page-products" class="page">
            <div class="container">
                <div class="products-page">
                    <div class="products-page__header">
                        <h2>Nossos Produtos</h2>
                        <div class="products-filters">
                            <select class="form-control" id="category-filter">
                                <option value="Todas">Todas as categorias</option>
                            </select>
                            <div class="search-box">
                                <input type="text" class="form-control" id="search-input" placeholder="Buscar produtos...">
                            </div>
                        </div>
                    </div>
                    <div class="products-grid" id="products-grid">
                        <!-- Products will be loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Product Detail Page -->
        <section id="page-product-detail" class="page">
            <div class="container">
                <div class="product-detail" id="product-detail-content">
                    <!-- Product detail will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Cart Page -->
        <section id="page-cart" class="page">
            <div class="container">
                <div class="cart-page">
                    <h2>Seu Carrinho</h2>
                    <div class="cart-content" id="cart-content">
                        <!-- Cart items will be loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Checkout Page -->
        <section id="page-checkout" class="page">
            <div class="container">
                <div class="checkout-page">
                    <h2>Finalizar Compra</h2>
                    <form class="checkout-form" id="checkout-form">
                        <div class="checkout-sections">
                            <div class="checkout-section">
                                <h3>Dados Pessoais</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Nome Completo</label>
                                        <input type="text" class="form-control" name="nome" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-control" name="email" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Telefone</label>
                                        <input type="tel" class="form-control" name="telefone" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">CPF</label>
                                        <input type="text" class="form-control" name="cpf" required>
                                    </div>
                                </div>
                            </div>

                            <div class="checkout-section">
                                <h3>Endere√ßo de Entrega</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">CEP</label>
                                        <input type="text" class="form-control" name="cep" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Rua</label>
                                        <input type="text" class="form-control" name="rua" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">N√∫mero</label>
                                        <input type="text" class="form-control" name="numero" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Complemento</label>
                                        <input type="text" class="form-control" name="complemento">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Bairro</label>
                                        <input type="text" class="form-control" name="bairro" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Cidade</label>
                                        <input type="text" class="form-control" name="cidade" required>
                                    </div>
                                </div>
                            </div>

                            <div class="checkout-section">
                                <h3>Op√ß√µes de Frete</h3>
                                <div class="shipping-options" id="shipping-options">
                                    <!-- Shipping options will be loaded here -->
                                </div>
                            </div>

                            <div class="checkout-section">
                                <h3>Forma de Pagamento</h3>
                                <div class="payment-options">
                                    <label class="payment-option">
                                        <input type="radio" name="pagamento" value="cartao" required>
                                        <span>Cart√£o de Cr√©dito</span>
                                    </label>
                                    <label class="payment-option">
                                        <input type="radio" name="pagamento" value="pix" required>
                                        <span>PIX</span>
                                    </label>
                                    <label class="payment-option">
                                        <input type="radio" name="pagamento" value="boleto" required>
                                        <span>Boleto</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="checkout-summary">
                            <div class="card">
                                <div class="card__body">
                                    <h4>Resumo do Pedido</h4>
                                    <div class="summary-items" id="checkout-summary">
                                        <!-- Summary will be loaded here -->
                                    </div>
                                    <button type="submit" class="btn btn--primary btn--full-width">Finalizar Pedido</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Success Page -->
        <section id="page-success" class="page">
            <div class="container">
                <div class="success-page">
                    <div class="success-content">
                        <div class="success-icon">
                            <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22,4 12,14.01 9,11.01"></polyline>
                            </svg>
                        </div>
                        <h2>Pedido Realizado com Sucesso!</h2>
                        <p>Obrigada pela sua compra! Em breve voc√™ receber√° um email com os detalhes do seu pedido.</p>
                        <button class="btn btn--primary btn--lg" data-action="continue-shopping">Continuar Comprando</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Page -->
        <section id="page-about" class="page">
            <div class="container">
                <div class="about-page">
                    <h2>Sobre a Lumos Moda Fitness</h2>
                    <div class="about-content">
                        <div class="about-text">
                            <p>A Lumos √© mais que uma marca de moda fitness - somos uma comunidade que acredita no poder transformador do movimento.</p>
                            <p>Criamos pe√ßas que acompanham mulheres reais na rotina, no treino e na vida, sempre com o compromisso de oferecer qualidade, conforto e estilo.</p>
                            <p>Nossa miss√£o √© inspirar mulheres a brilharem em todos os momentos, proporcionando roupas que valorizam cada corpo e cada movimento.</p>
                        </div>
                        <div class="contact-info">
                            <h3>Entre em Contato</h3>
                            <div class="contact-item">
                                <strong>WhatsApp:</strong> (11) 99999-9999
                            </div>
                            <div class="contact-item">
                                <strong>Email:</strong> contato@lumosfitness.com
                            </div>
                            <div class="contact-item">
                                <strong>Instagram:</strong> @lumosmodafitness
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Page -->
        <section id="page-admin" class="page">
            <div class="container">
                <div class="admin-page">
                    <h2>Painel Administrativo</h2>
                    <div class="admin-stats">
                        <div class="stat-card">
                            <h4>Total de Produtos</h4>
                            <span class="stat-number" id="total-products">6</span>
                        </div>
                        <div class="stat-card">
                            <h4>Itens no Estoque</h4>
                            <span class="stat-number" id="total-stock">98</span>
                        </div>
                        <div class="stat-card">
                            <h4>Categorias</h4>
                            <span class="stat-number" id="total-categories">6</span>
                        </div>
                    </div>
                    <div class="admin-products">
                        <h3>Gerenciar Produtos</h3>
                        <div class="products-table" id="admin-products-table">
                            <!-- Admin products table will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__brand">
                    <h4>Lumos Moda Fitness</h4>
                    <p>Luz que inspira movimento</p>
                </div>
                <div class="footer__links">
                    <div class="footer__section">
                        <h5>Produtos</h5>
                        <a href="#" data-category="Leggings">Leggings</a>
                        <a href="#" data-category="Tops">Tops</a>
                        <a href="#" data-category="Conjuntos">Conjuntos</a>
                    </div>
                    <div class="footer__section">
                        <h5>Atendimento</h5>
                        <a href="#" target="_blank">WhatsApp</a>
                        <a href="#" target="_blank">Email</a>
                        <a href="#" target="_blank">Instagram</a>
                    </div>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2024 Lumos Moda Fitness. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Product Modal -->
    <div class="modal hidden" id="product-modal">
        <div class="modal__overlay" data-action="close-modal"></div>
        <div class="modal__content">
            <button class="modal__close" data-action="close-modal">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="modal__body" id="modal-body">
                <!-- Modal content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- ‚úÖ Scripts Firebase integrados -->
    <script src="app.js"></script>
    
    <!-- ‚úÖ Script adicional para Firebase -->
    <script>
        // ‚úÖ Fun√ß√µes Firebase para app.js
        window.FirebaseLumos = {
            // Salvar produto no Firebase
            async salvarProduto(produto) {
                console.log('üîÑ SID: Salvando produto no Firebase:', produto);
                try {
                    const produtoRef = window.firebaseRef(window.firebaseDatabase, `produtos/${produto.id}`);
                    await window.firebaseSet(produtoRef, {
                        ...produto,
                        marca: 'Lumos Fitness',
                        atualizadoEm: window.firebaseServerTimestamp()
                    });
                    console.log('‚úÖ SID: Produto salvo no Firebase!');
                    return true;
                } catch (error) {
                    console.error('‚ùå SID: Erro ao salvar produto:', error);
                    return false;
                }
            },

            // Salvar carrinho no Firebase
            async salvarCarrinho(sessionId, carrinho) {
                console.log('üîÑ SID: Salvando carrinho no Firebase:', sessionId);
                try {
                    const carrinhoRef = window.firebaseRef(window.firebaseDatabase, `carrinhos/${sessionId}`);
                    await window.firebaseSet(carrinhoRef, {
                        ...carrinho,
                        atualizadoEm: window.firebaseServerTimestamp()
                    });
                    console.log('‚úÖ SID: Carrinho salvo no Firebase!');
                    return true;
                } catch (error) {
                    console.error('‚ùå SID: Erro ao salvar carrinho:', error);
                    return false;
                }
            },

            // Salvar pedido no Firebase
            async salvarPedido(pedido) {
                console.log('üîÑ SID: Salvando pedido no Firebase:', pedido);
                try {
                    const pedidosRef = window.firebaseRef(window.firebaseDatabase, 'pedidos');
                    const novoPedidoRef = window.firebasePush(pedidosRef);
                    await window.firebaseSet(novoPedidoRef, {
                        ...pedido,
                        id: novoPedidoRef.key,
                        empresa: 'Lumos Fitness',
                        criadoEm: window.firebaseServerTimestamp()
                    });
                    console.log('‚úÖ SID: Pedido salvo no Firebase!');
                    return { success: true, id: novoPedidoRef.key };
                } catch (error) {
                    console.error('‚ùå SID: Erro ao salvar pedido:', error);
                    return { success: false, error: error.message };
                }
            },

            // Buscar dados do Firebase
            async buscarDados(path) {
                console.log('üîÑ SID: Buscando dados:', path);
                try {
                    const dataRef = window.firebaseRef(window.firebaseDatabase, path);
                    const snapshot = await window.firebaseGet(dataRef);
                    
                    if (snapshot.exists()) {
                        console.log('‚úÖ SID: Dados encontrados:', path);
                        return { success: true, data: snapshot.val() };
                    } else {
                        console.log('‚ö†Ô∏è SID: Nenhum dado encontrado:', path);
                        return { success: true, data: null };
                    }
                } catch (error) {
                    console.error('‚ùå SID: Erro ao buscar dados:', error);
                    return { success: false, error: error.message };
                }
            }
        };
        
        // ‚úÖ Integra√ß√£o com app.js existente
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ SID: Sistema Lumos com Firebase ativo!');
            
            // Interceptar opera√ß√µes do carrinho para salvar no Firebase
            const originalUpdateCartCount = window.updateCartCount;
            if (originalUpdateCartCount) {
                window.updateCartCount = function() {
                    originalUpdateCartCount();
                    
                    // Salvar carrinho no Firebase
                    const sessionId = 'lumos_session_' + Date.now();
                    if (window.appState && window.appState.cart) {
                        window.FirebaseLumos.salvarCarrinho(sessionId, {
                            itens: window.appState.cart,
                            total: window.appState.cart.reduce((sum, item) => sum + item.total, 0)
                        });
                    }
                };
            }
            
            // Interceptar checkout para salvar pedidos no Firebase
            const originalProcessCheckout = window.processCheckout;
            if (originalProcessCheckout) {
                window.processCheckout = async function(formData) {
                    const result = originalProcessCheckout(formData);
                    
                    // Salvar pedido no Firebase
                    if (window.appState && window.appState.cart.length > 0) {
                        await window.FirebaseLumos.salvarPedido({
                            cliente: formData,
                            itens: window.appState.cart,
                            status: 'pendente',
                            origem: 'site_lumos'
                        });
                    }
                    
                    return result;
                };
            }
        });
    </script>
</body>
</html>